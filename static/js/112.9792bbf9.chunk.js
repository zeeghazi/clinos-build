(this.webpackJsonpAvonEMR=this.webpackJsonpAvonEMR||[]).push([[112],{1128:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return P}));var n=a(21),s=a.n(n),c=a(33),i=a(29),r=a(0),o=a(436),l=a(414),d=a(438),u=a(411),j=a(95),m=a(43),p=a.n(m),b=a(99),g=a(16),O=a(533),f=a(56),h=a.n(f),x=a(44),v=a(57),M=new function e(){Object(O.a)(this,e),this.getMessages=function(){return h.a.get("".concat(x.a,"/client-portal/messages"),{headers:Object(v.a)()})},this.getMessageUsers=function(){return h.a.get("".concat(x.a,"/client-portal/messages/users"),{headers:Object(v.a)()})},this.createMessage=function(e){return h.a.post("".concat(x.a,"/client-portal/messages"),e,{headers:Object(v.a)()})},this.updateMessage=function(e){return h.a.put("".concat(x.a,"/client-portal/messages/").concat(e.data.id),e,{headers:Object(v.a)()})},this.deleteMessage=function(e){return h.a.delete("".concat(x.a,"/client-portal/messages/").concat(e),{headers:Object(v.a)()})}},y=a(439),N=a(455),w=a(452),S=a(456),C=a(451),k=a(469),_=a(470),T=a(477),B=a(1),z=Object(o.a)((function(e){return{modalTitle:{backgroundColor:e.palette.primary.light,"& h2":{color:"#fff",fontSize:"16px"}},modalContent:{paddingLeft:e.spacing(3),paddingTop:e.spacing(3),paddingRight:e.spacing(3),paddingBottom:e.spacing(6),fontSize:"18px","& p":{fontSize:"16px"}},modalAction:{borderTop:"1px solid ".concat(e.palette.background.default),display:"flex",justifyContent:"space-between",paddingTop:e.spacing(2),paddingBottom:e.spacing(2),paddingLeft:e.spacing(3),paddingRight:e.spacing(3)},gutterBottom:{marginBottom:e.spacing(2)},w100:{minWidth:100}}})),R=function(e){var t=e.isOpen,a=e.onClose,n=e.selectedMessage,s=e.title,c=e.reloadData,o=z(),d=Object(b.b)().enqueueSnackbar,u=Object(r.useState)([]),j=Object(i.a)(u,2),m=j[0],p=j[1],g=Object(r.useState)(""),O=Object(i.a)(g,2),f=O[0],h=O[1],x=Object(r.useState)(""),v=Object(i.a)(x,2),R=v[0],A=v[1],E=Object(r.useState)(""),P=Object(i.a)(E,2),W=P[0],D=P[1];Object(r.useEffect)((function(){M.getMessageUsers().then((function(e){p(e.data.data)})),n&&(D(n.subject),A(n.message),h(n.user_id_to))}),[n]);var F=function(){a()};return Object(B.jsxs)(N.a,{maxWidth:"sm",open:t,onClose:F,children:[Object(B.jsx)(C.a,{className:o.modalTitle,children:s}),Object(B.jsx)(S.a,{className:o.modalContent,style:{minWidth:"600px"},children:Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(B.jsxs)(k.a,{variant:"outlined",className:o.customSelect,size:"small",children:[Object(B.jsx)(_.a,{htmlFor:"age-native-simple",children:"To"}),Object(B.jsxs)(T.a,{native:!0,value:f,onChange:function(e){return h(e.target.value)},inputProps:{name:"type",id:"age-native-simple"},label:"To",className:o.gutterBottom,children:[Object(B.jsx)("option",{"aria-label":"None",value:""}),m.map((function(e){return Object(B.jsx)("option",{value:e.id,children:"".concat(e.firstname," ").concat(e.lastname)},e.id)}))]})]}),Object(B.jsx)(y.a,{variant:"outlined",name:"notes",id:"notes",type:"text",label:"Message",required:!0,fullWidth:!0,value:R,onChange:function(e){return A(e.target.value)},multiline:!0,rows:5})]})}),Object(B.jsxs)(w.a,{className:o.modalAction,children:[Object(B.jsx)(l.a,{variant:"outlined",className:o.w100,onClick:F,children:"Cancel"}),n?Object(B.jsx)(l.a,{variant:"outlined",color:"primary",className:o.w100,onClick:function(){return function(){var e={data:{id:n.id,user_id_to:f,subject:W,message:R}};M.updateMessage(e).then((function(e){d("".concat(e.data.message),{variant:"success"}),c(),F()}))}()},children:"Update"}):Object(B.jsx)(l.a,{variant:"outlined",color:"primary",className:o.w100,onClick:function(){return function(){var e={data:{user_id_to:f,subject:W,message:R}};M.createMessage(e).then((function(e){d("".concat(e.data.message),{variant:"success"}),c(),F()}))}()},children:"Send"})]})]})};R.defaultProps={selectedMessage:null};var A=R,E=Object(o.a)((function(e){return{root:{flexGrow:1,padding:"40px 0px"},title:{paddingBottom:e.spacing(1)},titleSection:{display:"flex",alignItems:"center"},newMessage:{fontSize:"14px",marginLeft:e.spacing(4)},content:{marginTop:"30px"},divider:{margin:"10px 0 16px 0"},labelBold:{fontWeight:"bold"},mr1:{marginRight:e.spacing(1)}}}));function P(){var e=E(),t=Object(g.a)().user,a=Object(b.b)().enqueueSnackbar,n=Object(r.useState)([]),o=Object(i.a)(n,2),m=o[0],O=o[1],f=Object(r.useState)(null),h=Object(i.a)(f,2),x=h[0],v=h[1],y=Object(r.useState)(!1),N=Object(i.a)(y,2),w=N[0],S=N[1],C=Object(r.useState)("new"),k=Object(i.a)(C,2),_=k[0],T=k[1],z=function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getMessages();case 2:t=e.sent,O(t.data.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){z()}),[]);var R=Object(r.useCallback)((function(e){var t="",a=null===e||void 0===e?void 0:e.subject;return"new"===_?t="Send A Secure Message":"edit"===_?t="Edit Message || ".concat(a):"reply"===_&&(t="Reply Message || ".concat(a)),t}),[_]),P="".concat(t.firstname," ").concat(t.lastname);return Object(B.jsxs)(B.Fragment,{children:[w&&Object(B.jsx)(A,{isOpen:w,onClose:function(){S(!1),x&&v(null)},title:R(x),reloadData:z,selectedMessage:x}),Object(B.jsxs)("div",{className:e.root,children:[Object(B.jsxs)("div",{className:e.titleSection,children:[Object(B.jsx)(j.a,{component:"h1",variant:"h2",color:"textPrimary",className:e.title,children:"Messages"}),Object(B.jsx)(l.a,{className:e.newMessage,onClick:function(){return T("new"),void S(!0)},variant:"outlined",color:"primary",children:"New Message"})]}),Object(B.jsx)(j.a,{component:"p",variant:"body2",color:"textPrimary",children:"This page is used to send administrative messages to your practitioner. To send a new message click New Message."}),Object(B.jsx)("div",{className:e.content,children:m.map((function(t){return Object(B.jsxs)("div",{children:[Object(B.jsxs)(d.a,{container:!0,spacing:4,alignItems:"flex-start",children:[Object(B.jsx)(d.a,{item:!0,xs:6,children:Object(B.jsxs)(j.a,{component:"p",variant:"body2",color:"textPrimary",children:[Object(B.jsx)("span",{className:e.labelBold,children:"Time: "}),Object(B.jsx)("span",{className:e.mr1,children:p()(t.created).format("ll, h:mmA")}),Object(B.jsx)("span",{className:e.labelBold,children:"From: "}),Object(B.jsx)("span",{className:e.mr1,children:t.user_to_from||t.patient_to_from}),Object(B.jsx)("span",{className:e.labelBold,children:"To: "}),Object(B.jsx)("span",{className:e.mr1,children:t.user_to_name?t.user_to_name:P}),Object(B.jsx)("br",{}),t.message]})}),Object(B.jsx)(d.a,{item:!0,xs:6,children:Object(B.jsxs)(d.a,{container:!0,spacing:2,children:[Object(B.jsx)(d.a,{item:!0,children:t.user_id_from&&Object(B.jsx)(l.a,{size:"small",variant:"outlined",onClick:function(){return function(e){T("reply"),v(e),S(!0)}(t)},children:"Reply"})}),(n=t.created,p()().subtract(60,"minutes").format()<p()(n).format()&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(d.a,{item:!0,children:Object(B.jsx)(l.a,{size:"small",variant:"outlined",onClick:function(){return function(e){T("edit"),v(e),S(!0)}(t)},children:"Edit"})}),Object(B.jsx)(d.a,{item:!0,children:Object(B.jsx)(l.a,{size:"small",variant:"outlined",onClick:function(){return function(e){M.deleteMessage(e.id).then((function(e){a("".concat(e.data.message),{variant:"success"}),z()}))}(t)},children:"Delete"})})]}))]})})]}),Object(B.jsx)(u.a,{className:e.divider})]},t.id);var n}))})]})]})}}}]);
//# sourceMappingURL=112.9792bbf9.chunk.js.map